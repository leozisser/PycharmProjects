# -*- coding: utf-8 -*-
import xlwt, xlrd
# name = 'direct_example(copy)'
# from xlrd import open_workbook
from xlutils.copy import copy
import xlutils


def xl(clusters, loners, filename):
    template_name = "direct_example"
    name = 'vremenaya_registraciya_moskovskaya_oblast'
    link = 'http://ooo-777.moscow/?utm_source=yandex_poisk&utm_medium=cpc&utm_term={keyword}&utm_content={position}/{position_type}&utm_campaign='+ name +'&type={source_type}&source={source}'
    # print(len(loners))
    totalgroups = len(clusters) + len(loners)
    campname = filename.strip('.txt')
    rb = xlrd.open_workbook(template_name + '.xls', formatting_info=True)
    sheet = rb.sheet_by_index(0)
    wb = xlutils.copy.copy(rb)
    s = wb.get_sheet(0)
    data = [sheet.cell_value(12, col) for col in range(sheet.ncols)]
    for i in range(totalgroups):
        for index, value in enumerate(data):
            s.write(12 + i, index, value)
    counter = 0
    s.write(11 + counter, 4, 'templates')
    s.write(11 + counter, 10, '#' + campname + '#')
    counter += 1
    for a in clusters:
        s.write(11 + counter, 4, a)
        s.write(11 + counter, 5, str(counter))
        s.write(11+counter, 17, link)
        counter += 1
    for b in loners:
        s.write(11 + counter, 8, b)
        s.write(11 + counter, 17, link)
        counter += 1

    wb.save('кампания ' + campname + '.xls')
    print('xl created')
    return 0

# campname_ = "direct_example"
# clusters_ = {'рф для гражданин ребёнок регистрация москва': [497, 536, 1496, 1058, 472, 812, 1154, 1500, 1505, 1663, 538, 384, 507, 204, 442, 526, 534, 979, 1585, 548, 751, 955, 353, 529, 553, 739, 1123, 1135, 1139, 1149, 1162, 1175, 960, 1051, 742], 'пребывание место регистрация по': [1424, 1186, 1434, 1435], 'рф для гражданин временной регистрация москва': [1656, 459, 919, 930, 1268, 1692, 575], 'для гражданин купить регистрация москва украина': [489, 593, 1109, 1016, 596, 256, 798], 'год для регистрация москва на белорус': [699, 1073, 1375, 258, 752, 950, 1, 691, 725, 1377], 'пребывание место регистрация срок москва по': [777, 1428, 28, 33, 778, 1420, 1421, 1422, 1425, 1426, 1427, 1429, 1431, 1432, 1433, 1437, 1438, 1439, 1440, 1510, 1612, 1681, 1649, 1444, 1448, 1479, 786], 'пребывание гражданин место регистрация москва по': [970, 991, 976], 'пребывание иностранец место регистрация москва по': [1271, 1423], 'пребывание цена место регистрация москва по': [1430, 1436, 1468, 1698], 'где официальный можно регистрация москва получить': [37, 82, 53, 64, 77, 127], 'где сделать официально можно регистрация москва': [38, 78, 72, 141, 837, 759, 834], 'делать рф где гражданин регистрация москва': [48, 56, 97], 'где гражданин рб сделать регистрация москва': [131, 133, 379, 1565], 'для гражданин снг гостевой регистрация москва': [158, 169, 167, 1294, 1596, 162, 163], 'рф для гражданин цена регистрация москва': [216, 475, 983, 1696, 523], 'год для украинец регистрация москва на': [241, 1371, 1664], 'рф для гражданин работа регистрация москва': [396, 1150], 'рф для гражданин регистрация москва дёшево': [460, 1096, 418], 'рф для гражданин купить регистрация москва': [463, 592], 'рф для гражданин официально регистрация москва': [467, 1097], 'быстро для гражданин снг регистрация москва': [477, 1099], 'для гражданин снг официально регистрация москва': [480, 755], 'для гражданин снг цена регистрация москва': [483, 1101], 'для гражданин цена регистрация москва украина': [491, 1111], 'для область житель регистрация москва московский': [505, 1120, 1119, 500, 502, 503, 1302, 1182, 270, 559, 1180, 1184, 1493], 'школа ребёнок регистрация москва': [817, 812], 'год цена три регистрация москва на': [726, 1385, 1281], 'жительство стоимость место регистрация москва по': [775, 1416, 1579, 1623, 1627, 1639], 'гражданин грузия сайт официальный регистрация москва': [957, 1042, 1237], 'рф гражданин территория регистрация москва на': [988, 989, 969, 1270], 'гражданин казахстан сайт официальный регистрация москва': [1024, 1033, 1181], 'жительство место купить регистрация москва по': [1408, 1413], 'жительство цена место регистрация москва по': [1409, 1704], 'для детский сад ребёнок регистрация москва': [1498, 1504, 1499], 'иностранный для гражданин стоимость регистрация москва': [1633, 1654, 1127, 1630, 1128, 1641], 'рф для гражданин регистрация москва': [516, 544, 1539, 15, 273, 914, 1098, 844, 665, 1455, 193, 326, 458, 205, 461, 462, 464, 465, 466, 468, 469, 471, 470, 472, 473, 474, 476, 495], 'для гражданин снг регистрация москва': [478, 265, 481, 482, 484, 545, 1100, 1102, 1296, 1595, 479], 'жительство место регистрация москва по': [1415, 773, 1410, 1411, 1412, 774, 776, 1414, 1417, 1418, 1419, 1433, 1581, 1466, 1509, 1405, 1406, 1407], 'иностранный для гражданин регистрация москва': [517, 161, 514, 515, 1125, 518, 1126, 1176], 'для гражданин регистрация москва украина': [490, 269, 1350, 492, 1497, 496, 1110, 1112, 1113, 1114], 'для гражданин беларусь регистрация москва': [434, 450, 453, 1094, 430, 431, 432, 433, 1081, 1391, 1537], 'для гражданин рб регистрация москва': [451, 230, 452, 454, 1093, 1594], 'белоруссия для гражданин регистрация москва': [1083, 435, 1608, 436, 1593, 1084, 1085, 1086], 'где сделать временной регистрация москва': [85, 43, 71, 145, 121, 122, 123, 124], 'узбекистан для гражданин регистрация москва': [487, 159, 488, 1107, 1108, 486], 'для гражданин армения регистрация москва': [428, 429, 1080, 494, 1631, 423], 'для гражданин молдова регистрация москва': [446, 444, 1092, 445, 447], 'для гражданин россия регистрация москва': [455, 231, 1095, 456, 457, 1454, 276, 287, 525], 'для гражданин казахстан регистрация москва': [439, 438, 440, 1089], 'где можно регистрация москва получить': [81, 74, 80, 83, 84, 90], 'гражданин сайт официальный регистрация москва': [1032, 951, 994, 965, 1007, 1009, 1238, 1050], 'где сделать можно регистрация москва': [89, 75, 363, 86, 87, 88], 'где временной регистрация москва получить': [103, 101, 104, 113], 'для гражданин молдавия регистрация москва': [1632, 157, 1091, 443], 'год стоимость регистрация москва на': [1625, 240, 674, 1636, 1637, 1638, 684, 1646, 1363, 701], 'где гражданин сделать регистрация москва': [134, 132, 147, 135], 'год для регистрация москва на': [520, 698], 'где сделать официально регистрация москва': [39, 91, 140], 'делать где временной регистрация москва': [52, 34, 69], 'где купить временной регистрация москва': [63, 66, 76], 'где официальный регистрация москва получить': [106, 108, 109], 'житель для регистрация': [160, 504, 604, 509], 'для детский сад регистрация москва': [499, 1116, 1145, 1117], 'год цена регистрация москва на': [675, 718, 1358, 1380], 'месяц цена регистрация москва на': [727, 679, 688, 1700], 'прибывания место регистрация москва по': [1443, 1441, 1442], 'для стоимость временной регистрация москва': [1614, 1615, 1616], 'адрес конкретный регистрация москва по': [22, 770, 771, 1404], 'область для регистрация москва московский': [448, 524], 'донбасс для житель регистрация москва': [501, 1118, 1179], 'для житель регистрация москва подмосковье': [506, 1121, 552], 'для житель регистрация москва украина': [508, 1122, 1192], 'область житель регистрация москва московский': [556, 1188], 'иностранный гражданин стоимость регистрация москва': [585, 1642], 'место проживание регистрация москва по': [779, 1445, 1446], 'рф гражданин официально регистрация москва': [982, 1347], 'гражданин украина регистрация москва на': [1019, 1013], 'место ребёнок регистрация москва по': [1508, 1510], 'где официально регистрация москва получить': [40, 107], 'где оформить временной регистрация москва': [93, 92, 764], 'оформлять где временной регистрация москва': [96, 98, 99], 'обучение для школа регистрация москва': [528, 1144, 207, 510], 'для школа поступление регистрация москва': [531, 1146], 'рф для легально регистрация москва': [605, 1279], 'место работа регистрация москва по': [780, 1447], 'область регистрация москва московский по': [782, 1457, 1472], 'беларусь сайт официальный регистрация москва': [1067, 1536], 'область цена регистрация москва московский': [1301, 573], 'пребывание временной регистрация москва по': [1403, 1612], 'где продлить временной регистрация москва': [117, 118, 119], 'где снг сделать регистрация москва': [136, 148], 'месяц дешёвый регистрация москва на': [186, 678], 'для гражданин регистрация москва киргизия': [441, 1090], 'для гражданин таджикистан регистрация москва': [485, 1105], 'иностранец для купить регистрация москва': [519, 1131], 'иностранец для цена регистрация москва': [521, 1133], 'для купить регистрация москва россиянин': [539, 1155, 1516], 'для цена регистрация москва россиянин': [540, 1156, 1518], 'для цена украинец регистрация москва': [550, 1172], 'доставка дом регистрация москва на': [555, 827, 704, 1532], 'или область регистрация москва московский': [578, 1635], 'год купить регистрация москва на': [682, 1362, 1307], 'год официально регистрация москва на': [683, 758], 'время учёба регистрация москва на': [695, 1370, 694], 'работа при регистрация москва на': [792, 793, 795], 'год до ребёнок регистрация москва': [813, 1059], 'гражданин нужный регистрация москва украина': [1014, 1020], 'проживание временной регистрация москва на': [1368, 1369], 'срочный обращение день регистрация москва': [1591, 1604, 317, 1611], 'стоимость годовой временной регистрация москва': [1618, 1619, 1620], 'гражданин услуга регистрация москва по': [1677, 1678, 1682], 'гражданин фирма регистрация москва по': [1684, 1690], 'для гражданин регистрация москва': [1384, 427, 1079, 1082, 1087, 1088, 1104, 1106, 1136, 437, 442, 449, 493], 'рф гражданин регистрация москва': [168, 198, 384, 385, 1027, 1029, 405, 984, 979, 1215, 1600, 980, 328, 981, 204, 983, 97, 737, 986, 382, 383], 'иностранный гражданин регистрация москва': [937, 235, 274, 1305, 1696, 310, 1601, 1223, 584, 586, 1224, 1225, 1228, 1230, 1231, 1232, 1233, 1234, 1235, 1236, 1237, 1239, 1240, 1241, 1242, 1243, 1244, 1245, 1246, 1247, 1248, 1249, 1250, 236, 237, 238], 'россия гражданин регистрация москва': [110, 182, 1026, 395, 1295, 1048, 410, 411, 1348, 973, 974, 975, 976, 736, 1002, 381], 'гражданин регистрация москва украина': [1021, 14, 391, 399, 1685, 406, 151, 1055, 183, 1349, 1016, 993, 738, 1012, 1015, 376, 1017], 'гражданин снг регистрация москва': [1003, 227, 388, 389, 1668, 1294, 167, 995, 998, 999, 1000, 1004], 'где сделать регистрация москва': [130, 125, 128, 129, 137, 138, 139, 141, 142, 143, 72, 366, 126, 127], 'белоруссия гражданин регистрация москва': [1693, 176, 393, 1037, 400, 401, 1040, 1041, 408, 948, 949, 950, 952, 953, 959, 1630, 992, 1023], 'год регистрация москва на': [190, 606, 1281, 258, 1354, 722, 752], 'область регистрация москва московский': [50, 568, 1302, 1303, 920, 668, 1320, 572, 574, 1353, 1488], 'для регистрация москва белорус': [1075, 1072, 257, 1069, 1070, 1071, 1074, 152, 156], 'где регистрация москва получить': [111, 42, 1566, 70, 105], 'где временной регистрация москва': [45, 94], 'для украинец регистрация москва': [549, 1299], 'для регистрация москва россиянин': [935, 170, 206, 1521, 570], 'для регистрация москва украина': [1066, 426], 'для иногородний регистрация москва': [1624, 512, 513, 1124], 'делать где регистрация москва': [51, 36, 47, 49, 53, 54, 55, 59], 'адрес регистрация москва по': [783, 23, 768, 772, 1450, 1465, 784, 1264, 1400, 1401, 1402, 767], 'где можно регистрация москва': [79, 77], 'гражданин беларусь регистрация москва': [1592, 374, 1031, 1289, 947, 1391, 375], 'для трудоустройство регистрация москва': [1640, 546], 'сайт официальный регистрация москва': [716, 1549, 1181], 'для студент регистрация москва': [1167, 856, 1127], 'цена временной регистрация москва': [1694, 4, 1697, 925], 'стоимость регистрация москва на': [1647, 714, 1648], 'для официально регистрация москва': [756, 837], 'иностранец для регистрация москва': [1130, 1129, 1132, 1134], 'гражданин казахстан регистрация москва': [380, 177, 961, 1034, 1293, 403, 1044], 'полгода регистрация москва на': [715, 1554], 'услуга регистрация москва по': [1675, 1688, 1676, 1679, 1681, 1683], 'гражданин официально регистрация москва': [954, 379], 'где официальный регистрация москва': [46, 64], 'месяц регистрация москва на': [165, 279, 419, 1519, 1361, 735], 'пребывание временной регистрация москва': [938, 936, 1392], 'гражданин таджикистан регистрация москва': [1005, 390, 1052, 1006], 'временной регистрация москва срочно': [1609, 356, 923, 1606], 'стоимость временной регистрация москва': [1613, 1617, 1626], 'иностранец регистрация москва по': [1689, 1470], 'официальный временной регистрация москва': [8, 9, 934, 750, 921], 'для регистрация москва подмосковье': [530, 899, 552], 'житель регистрация москва подмосковье': [557, 558, 1189, 1190, 1195], 'доставка временной регистрация москва': [588, 187, 922], 'гражданин молдова регистрация москва': [179, 967, 968], 'гражданин иногородний регистрация москва': [1212, 581, 1211, 1213, 1214], 'приезжий из регистрация москва': [1485, 796, 1482, 1483, 1484, 797], 'где купить регистрация москва': [61, 65], 'проживание временной регистрация москва': [224, 939, 940, 941], 'для проживание регистрация москва': [232, 1148], 'гражданин армения регистрация москва': [407, 946, 1038], 'гражданин регистрация москва киргизия': [962, 214, 963, 228, 1045], 'узбекистан гражданин регистрация москва': [1011, 1054], 'гражданин российский регистрация москва': [1513, 977, 1512, 1514, 1515, 243], 'гражданин молдавия регистрация москва': [377, 966, 1046], 'для регистрация москва новорождённый': [527, 1142, 743], 'купить временной регистрация москва': [589, 932], 'форма ребёнок регистрация москва': [818, 1502], 'иностранец официальный регистрация москва': [1699, 1255], 'быстро регистрация москва недорого': [312, 311, 1452], 'купить регистрация москва срочно': [597, 590], 'регистрация москва район косино': [785, 805, 345], 'срочный за регистрация москва': [842, 1597, 1603], 'студент регистрация москва по': [1535, 1429], 'физический лицо регистрация москва': [1680, 1559, 1561, 1562], 'дешёвый временной регистрация москва': [184, 185, 189], 'проспект регистрация москва на': [707, 27, 705, 30], 'культура парк регистрация москва': [708, 625, 655], 'из ребёнок регистрация москва': [814, 1501], 'интернет через регистрация москва': [884, 1569, 1437], 'гражданин грузия регистрация москва': [958, 1043], 'иностранец стоимость регистрация москва': [1265, 1643, 1644], 'сколько стоить регистрация москва': [1461, 361, 761], 'срочный временной регистрация москва': [1610, 1590], 'временной регистрация москва дёшево': [5, 929, 930], 'проспект мир регистрация москва': [271, 628], 'гражданин регистрация москва азербайджан': [372, 1344], 'студент иногородний регистрация москва': [580, 1206, 1220], 'метро регистрация москва красный': [647, 648, 649], 'служба регистрация москва государственный': [1572, 1571, 174], 'стоимость проживание регистрация москва': [1651, 1652], 'услуга временной регистрация москва': [1672, 1674], 'доставка регистрация москва недорого': [24, 828], 'прописка регистрация без москва': [245, 1495], 'регистрация западный': [303, 320], 'иногородний регистрация москва россиянин': [582, 1218], 'ул регистрация москва на': [690, 728], 'улица регистрация москва на': [724, 729], 'доставка онлайн регистрация москва': [746, 748], 'алексеевский регистрация москва район': [802, 807, 305], 'онлайн регистрация москва поликлиника': [900, 903], 'временной справка регистрация москва': [1583, 1584], 'москва регистрация гражданин': [1551, 178, 196, 213, 261, 373, 378, 387, 739, 945, 955, 960, 969, 971, 1008, 1010, 1039, 1051, 1053, 1202, 1227, 1345, 1565], 'москва временной регистрация': [1288, 2, 3, 575, 1661, 1665, 1667, 1691, 1692, 173, 200, 1268, 1287, 854, 354, 924, 927, 931, 933, 1492], 'москва иногородний регистрация': [116, 1204, 1208, 1209, 1216, 1219, 1221], 'москва на регистрация': [709, 687, 689, 691, 692, 694, 704, 706, 711, 712, 717, 720, 723, 725, 733, 1270, 795, 1307, 1377], 'москва стоимость регистрация': [1308, 1628, 1544, 1655, 281, 1490, 1620, 1621, 1622, 1623, 1627, 1629, 1634, 1639, 1641, 1649, 1650, 1653], 'москва где регистрация': [62, 95, 119, 120], 'москва иностранец регистрация': [1254, 1259, 1272, 1, 278, 153, 171, 1602, 1506, 1253, 1257, 1261, 1262, 1263, 1266], 'москва официально регистрация': [1277, 166, 815, 1599, 579, 760, 754, 757, 759], 'москва цена регистрация': [1487, 829, 523, 1698, 1468, 1518], 'москва иностранный регистрация': [1226, 1222, 1229, 1251, 1128], 'москва сделать регистрация': [836, 192, 834, 835], 'москва регистрация купить': [595, 594, 256, 1586, 596, 876], 'москва метро регистрация': [645, 642, 643, 644, 646, 652, 653, 654, 656, 786, 787, 660, 661, 662, 663], 'москва официальный регистрация': [191, 280, 751], 'москва год регистрация': [250, 869], 'москва область регистрация': [1517, 634, 1598, 1493, 1119], 'москва ребёнок регистрация': [415, 638, 1154, 534, 538, 1057, 816, 1585, 1499, 1500, 1505, 1663], 'москва район регистрация': [335, 221, 806, 810, 325, 329, 330, 331, 332, 333, 334, 345], 'москва срочно регистрация': [848, 298, 1607, 845, 847, 1532], 'москва приезжий регистрация': [1480, 1478, 1479, 798], 'быстро москва регистрация': [308, 309, 732], 'москва московский регистрация': [895, 327], 'москва прописка регистрация': [1489, 29, 1201], 'москва день регистрация': [554, 317], 'москва регистрация без': [826, 299], 'москва легально регистрация': [763, 603, 608, 607], 'москва студент регистрация': [1657, 855, 1537, 1538, 858], 'москва свао регистрация': [337, 1555], 'месяц москва регистрация': [667, 306, 163], 'белорус москва регистрация': [254, 255], 'москва регистрация гостевой': [164, 162], 'москва регистрация срок': [318, 637], 'москва квартира регистрация': [794, 321, 323], 'москва улица регистрация': [871, 872], 'москва несовершеннолетний регистрация': [740, 1390], 'москва служба регистрация': [1575, 1576], 'москва округ регистрация': [352, 351, 839], 'москва поликлиника регистрация': [799, 353], 'москва ул регистрация': [865, 867, 868], 'москва домодедовский регистрация': [616, 850], 'москва шоссе регистрация': [348, 614, 888], 'москва ленинский регистрация': [620, 30]}
# #
# loners_ = ['регистрация в москве м речной вокзал', 'регистрация в москве с выездом курьера','регистрация в москве ближайшая м полежаевская','регистрация в москве в вао преображенское','регистрация в москве в железнодорожном','регистрация в москве в северовосточном р','регистрация в москве воронцово поле','регистрация в москве грохольский переулок','регистрация в москве м комсомольская','регистрация в москве м новокузнецкая','регистрация в москве м планерная м сходненская','регистрация в москве новослободская 20',' регистрация в москве новые черемушки,регистрация в москве первокласников','регистрация в москве покровское стрешнево','регистрация в москве самостоятельно','регистрация в москве страстной бульвар 12','регистрация в москве хорошево мневники','регистрация в москве чертаново южное','регистрация в москве щелковский 100','регистрация в первый класс в москве'.split(',')]
# #
# xl(clusters_, loners_, campname_)